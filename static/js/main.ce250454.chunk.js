(this.webpackJsonpcgof=this.webpackJsonpcgof||[]).push([[0],{33:function(e,t,n){},35:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var r,c=n(2),a=n(13),s=n.n(a),i=n(11),l=n(5),o=n(9),u=function(e,t){return"".concat(e,"x").concat(t)},d=function(e){return e.split("x").map(Number)},f=function(e,t,n,r){return[[e-1,t-1],[e,t-1],[e+1,t-1],[e-1,t],[e+1,t],[e-1,t+1],[e,t+1],[e+1,t+1]].map((function(e){var t=Object(o.a)(e,2),c=t[0],a=t[1];return c<0?c+=n:c>=n&&(c-=n),a<0?a+=r:a>=r&&(a-=r),[c,a]}))},b=function(e,t){if(e.size!==t.size)return!1;var n=!0;return e.forEach((function(e,r){!e!==!t.get(r)&&(n=!1)})),n?(t.forEach((function(t,r){!e.get(r)!==!t&&(n=!1)})),n):n},j=function(e,t){var n=t.xCount,r=t.yCount,c=e.keys(),a=[],s=Array.from(c);s.forEach((function(t){var c=d(t),s=Object(o.a)(c,2),i=s[0],l=s[1];f(i,l,n,r).forEach((function(t){var n=Object(o.a)(t,2),r=n[0],c=n[1],s=u(r,c);e.has(s)||a.push(s)}))}));var i=new Map;return s.concat(a).forEach((function(t){var c=e.has(t),a=d(t),s=Object(o.a)(a,2),l=s[0],b=s[1],j=0;f(l,b,n,r).forEach((function(t){var n=Object(o.a)(t,2),r=n[0],c=n[1];e.get(u(r,c))&&j++})),c?j>1&&j<4&&i.set(t,1):3===j&&i.set(t,1)})),i},m=n(1),h=function(e,t,n,r){if(!e.current)return console.warn("canvasRef is not rendered yet");var c=e.current.getContext("2d"),a=t.rectSize,s=t.xCount,i=t.yCount,l=t.cells.cells;n.forEach((function(e){var t=Object(o.a)(e,2),n=t[0],r=t[1];c.fillStyle="#FFF",c.fillRect(n*a+1,r*a+1,a-1,a-1)}));var b=[];l.forEach((function(e,t){var n=d(t),r=Object(o.a)(n,2),j=r[0],m=r[1];e&&f(j,m,s,i).forEach((function(e){var t=Object(o.a)(e,2),n=t[0],r=t[1],s=u(n,r),i=l.get(s);c.fillStyle=i?"#000":"#FFF",i&&b.push([n,r]),c.fillRect(n*a+1,r*a+1,a-1,a-1)})),c.fillStyle=e?"#000":"#FFF",e&&b.push([j,m]),c.fillRect(j*a+1,m*a+1,a-1,a-1)})),r(b)},p=function(e){var t=e.width,n=e.height,r=e.rectSize,a=e.onClick,s=e.xCount,i=e.yCount,u=e.cells,d=function(e){var t=Object(c.useRef)();return Object(c.useEffect)((function(){t.current=e})),t.current}(e),f=Object(c.useState)([]),j=Object(o.a)(f,2),p=j[0],v=j[1],O=Object(c.useRef)(null);Object(c.useEffect)((function(){!function(e,t){var n=!0;return Object.keys(e).forEach((function(r){e[r]!==t[r]&&(n=!1)})),n?(Object.keys(t).forEach((function(r){e[r]!==t[r]&&(n=!1)})),n):n}(Object(l.a)(Object(l.a)({},d),{},{onClick:null,cells:null}),Object(l.a)(Object(l.a)({},e),{},{onClick:null,cells:null}))?function(e,t,n,r){if(!e.current)return console.warn("canvasRef is not rendered yet");var c=t.rectSize,a=t.width,s=t.height,i=e.current.getContext("2d");i.clearRect(0,0,a,s),i.strokeStyle="#eee",i.beginPath(),i.globalAlpha=1;for(var l=s;l--;)i.moveTo(0,c*l),i.lineTo(c*a,c*l);for(var o=a;o--;)i.moveTo(c*o,0),i.lineTo(c*o,c*s);i.lineWidth=1,i.stroke(),i.closePath(),h(e,t,n,r)}(O,e,p,v):b(e.cells.cells,d.cells.cells)||h(O,e,p,v)}),[t,n,r,s,i,u]);return Object(m.jsx)("canvas",{className:"app-canvas",width:t,height:n,onClick:function(e){var t=e.nativeEvent,n=t.offsetX,c=t.offsetY,s=Math.floor(n/r),i=Math.floor(c/r);a({x:s,y:i})},ref:O})},v="WINDOW_SIZE_CHANGE",O="SCALE_CHANGE",x="TOGGLE_CELL",y="TOGGLE_CELL_DONE",g="ADD_PATTERN",N="ADD_PATTERN_DONE",E="PLAY_LIFE",w="STOP_LIFE",_="NEXT_STEP",C="NEXT_STEP_DONE",k="NEXT_STEP_ERROR",z="CHANGE_FREQUENCY",S="RESET_LIFE",R="REQUEST_PREVIOUS_STEP",P="RECEIVE_PREVIOUS_STEP",T="REQUEST_LAST_STEP",A="RESTORE_LIFE",L=function(){return{type:w}},F=function(){return{type:E}},I=Object(i.b)((function(e){return{size:e.size,cells:e.cells}}))((function(e){var t=e.size,n=e.cells,r=e.dispatch,a=Object(c.useRef)(null);Object(c.useEffect)((function(){r({type:T});var e=function(){var e;r((e={width:a.current.clientWidth,height:a.current.clientHeight},{type:v,sizes:e}))};return window.addEventListener("resize",e),e(),function(){window.removeEventListener("resize",e)}}),[]);return Object(m.jsx)("div",{className:"mdl-layout__content container-container",children:Object(m.jsx)("div",{className:"page-content container-content",ref:a,children:Object(m.jsx)(p,{onClick:function(e){return r(function(e){return{type:x,coords:e}}(e))},width:t.canvasWidth,height:t.canvasHeight,xCount:t.xCount,yCount:t.yCount,rectSize:t.rectSize,cells:n})})})})),M=function(e){var t=e.onAddPattern,n=Object(c.useRef)(null);return Object(m.jsxs)("div",{children:[Object(m.jsx)("div",{className:"pattern-textarea",children:Object(m.jsx)("textarea",{defaultValue:"\n        .*...\n        *.*.\n        *.**\n        .*...\n        ",ref:n,className:"mdl-textfield__input materialize-textarea pattern-textarea-input",name:"pattern",cols:"20",rows:"5"})}),Object(m.jsxs)("div",{className:"mdl-list",children:[Object(m.jsx)("output",{className:"mdl-list__item",children:"Paste a pattern into textarea above. Use symbol `*` - to make alive cells. Pattern will be inserted at the center of the canvas."}),Object(m.jsx)("div",{className:"pattern-inputs",children:Object(m.jsx)("div",{className:"buttons",children:Object(m.jsxs)("button",{onClick:function(){var e=n.current.value;n.current.value="",t(e)},className:"mdl-button mdl-js-button mdl-button--raised mdl-button--colored pattern-inputs-button",children:[Object(m.jsx)("i",{className:"material-icons",children:"content_paste"})," Add Pattern"]})})})]})]})},D=function(e){var t=e.onNext,n=e.onZoom,r=e.onPrev,c=e.onReset,a=e.onPlay,s=e.isPlaying;return Object(m.jsxs)("div",{className:"buttons",children:[Object(m.jsxs)("div",{children:[Object(m.jsx)("button",{onClick:r,className:"mdl-button mdl-js-button mdl-button--raised mdl-button--colored",id:"step-back",children:Object(m.jsx)("i",{className:"material-icons",children:"skip_previous"})}),Object(m.jsx)("button",{onClick:t,className:"mdl-button mdl-js-button mdl-button--raised mdl-button--colored",id:"step-forward",children:Object(m.jsx)("i",{className:"material-icons",children:"skip_next"})}),Object(m.jsx)("button",{onClick:a,className:"mdl-button mdl-js-button mdl-button--raised mdl-button--colored",children:Object(m.jsx)("i",{className:"material-icons",children:s?"pause":"play_arrow"})})]}),Object(m.jsxs)("div",{children:[Object(m.jsx)("button",{onClick:function(){return n(1)},className:"mdl-button mdl-js-button mdl-button--raised mdl-button--colored",id:"zoom-in",children:Object(m.jsx)("i",{className:"material-icons",children:"zoom_in"})}),Object(m.jsx)("button",{onClick:function(){return n(-1)},className:"mdl-button mdl-js-button mdl-button--raised mdl-button--colored",id:"zoom-out",children:Object(m.jsx)("i",{className:"material-icons",children:"zoom_out"})}),Object(m.jsx)("button",{onClick:c,className:"mdl-button mdl-js-button mdl-button--raised mdl-button--colored",children:Object(m.jsx)("i",{className:"material-icons",children:"stop"})})]})]})},q=function(e){var t=e.frequency,n=e.onChange;return Object(m.jsxs)("div",{className:"slider mdl-list",children:[Object(m.jsxs)("label",{htmlFor:"timeout-input",className:"mdl-list__item slider-label",children:[Object(m.jsx)("div",{className:"slider-label-text",children:"Frequency:"}),Object(m.jsxs)("div",{className:"slider-label-text",children:[t," cycles per minute"]})]}),Object(m.jsx)("div",{className:"",children:Object(m.jsx)("input",{value:t,onChange:function(e){return n(Number(e.target.value))},className:"mdl-list__item mdl-slider mdl-js-slider",id:"timeout-input",type:"range",max:"5000",min:"1",step:"1"})})]})},H=function(e){var t=e.onClick;return Object(m.jsx)("div",{className:"buttons mdl-list",children:Object(m.jsxs)("div",{onClick:t,className:"mdl-button mdl-js-button mdl-button--raised mdl-button--colored pattern-inputs-button",children:[Object(m.jsx)("i",{className:"material-icons",children:"timeline"})," Draw chart"]})})};function W(e,t,n){return function(e){return r||(r=new Promise((function(t,n){var r=indexedDB.open("".concat(e,"-db"),1);r.onerror=function(){n(r.error)},r.onupgradeneeded=function(){r.result.createObjectStore(e)},r.onsuccess=function(){t(r.result)}}))),r}(e).then((function(r){return new Promise((function(c,a){var s=r.transaction(e,t);s.oncomplete=function(){c()},s.onerror=function(){a(s.error)},n(s.objectStore(e))}))}))}function G(e){return this.name=e,this}G.prototype={get:function(e){var t;return W(this.name,"readonly",(function(n){t=n.get(e)})).then((function(){return t.result}))},set:function(e,t){return W(this.name,"readwrite",(function(n){n.put(t,e)}))},delete:function(e){return W(this.name,"readwrite",(function(t){t.delete(e)}))},getAll:function(){var e;return W(this.name,"readonly",(function(t){e=t.getAll()})).then((function(){return e.result}))},getLast:function(){var e=this;return this.keys().then((function(t){var n=t.pop();return Number.isInteger(n)?e.get(n).then((function(e){return{step:n,cells:e}})):null}))},clear:function(){return W(this.name,"readwrite",(function(e){e.clear()}))},keys:function(){var e=[];return W(this.name,"readonly",(function(t){(t.openKeyCursor||t.openCursor).call(t).onsuccess=function(){this.result&&(e.push(this.result.key),this.result.continue())}})).then((function(){return e}))}};var U=new G("life"),Y=function(){var e=window.open();e&&U.getAll().then((function(t){var n=t.map((function(e){return e.size})),r='<!DOCTYPE html>\n    <style>\n    html,body,svg { height:100%; width:100%;}\n    </style>\n<svg width="100%" height="100%"></svg>\n<script src="https://d3js.org/d3.v4.min.js"><\/script>\n<script>\nvar data = ['.concat(n,']\nvar svg = d3.select("svg"),\n    margin = {top: 20, right: 20, bottom: 30, left: 50},\n    width = window.innerWidth - margin.left - margin.right,\n    height = window.innerHeight - margin.top - margin.bottom,\n    g = svg.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");\nvar x = d3.scaleLinear()\n    .rangeRound([0, width]);\nvar y = d3.scaleLinear()\n    .rangeRound([height, 0]);\nvar area = d3.area()\n    .x(function(d, i) { return x(i); })\n    .y1(function(d) { return y(d); });\n  x.domain(d3.extent(data, function(d, i) { return i; }));\n  y.domain([0, d3.max(data, function(d) { return d; })]);\n  area.y0(y(0));\n  g.append("path")\n      .datum(data)\n      .attr("fill", "steelblue")\n      .attr("d", area);\n  g.append("g")\n      .attr("transform", "translate(0," + height + ")")\n      .call(d3.axisBottom(x))\n      .append("text")\n       .attr("fill", "#000")\n //      .attr("transform", "rotate(-90)")\n       .attr("x", width - 10)\n       .attr("y", 15)\n       .attr("dX", "0.7em")\n       .attr("text-anchor", "end")\n       .text("Cycles");\n      ;\n  g.append("g")\n      .call(d3.axisLeft(y))\n    .append("text")\n      .attr("fill", "#000")\n      .attr("transform", "rotate(-90)")\n      .attr("y", 6)\n      .attr("dy", "0.71em")\n      .attr("text-anchor", "end")\n      .text("Alive cells");\n<\/script>');e.document.write(r)}))},X=Object(i.b)((function(e){return{size:e.size,interval:e.interval}}))((function(e){var t=e.interval,n=e.dispatch;return Object(m.jsxs)("div",{className:"controls mdl-layout__drawer",children:[Object(m.jsx)(M,{isPlaying:t.running,onAddPattern:function(e){return n(function(e){return{type:g,pattern:e}}(e))}}),Object(m.jsx)(D,{isPlaying:t.running,onPlay:function(){return n(t.running?L():F())},onReset:function(){return n({type:S})},onPrev:function(){return n({type:R})},onZoom:function(e){return n(function(e){return{type:O,direction:e}}(e))},onNext:function(){return n({type:_})}}),Object(m.jsx)(q,{onChange:function(e){return n({type:z,frequency:e})},frequency:t.frequency}),Object(m.jsx)(H,{onClick:Y})]})})),B=function(e){var t=e.aliveCells,n=e.cycle,r=e.xSize,c=e.ySize,a=e.error;return Object(m.jsxs)("div",{className:"logs mdl-list",children:[Object(m.jsxs)("div",{className:"mdl-list__item logs-item",children:["Cycles: ",n]}),Object(m.jsxs)("div",{className:"mdl-list__item logs-item",children:["Board size: ",r,"x",c]}),Object(m.jsxs)("div",{className:"mdl-list__item logs-item",children:["Alive cells: ",t]}),Object(m.jsx)("div",{id:"info",className:"mdl-list__item logs-item error",children:a}),Object(m.jsx)("div",{className:"mdl-list__item message logs-item",children:"You can add or remove cells by clicking on canvas"})]})},V=Object(i.b)((function(e){return{size:e.size,cells:e.cells,interval:e.interval}}))((function(e){var t=e.dispatch,n=e.interval,r=e.size,c=e.cells;return Object(m.jsx)("div",{className:"mdl-layout__header",children:Object(m.jsxs)("div",{className:"mdl-layout__header-row",children:[Object(m.jsx)("span",{className:"mdl-layout-title"}),Object(m.jsx)("div",{className:"mdl-layout-spacer",children:Object(m.jsx)("div",{className:"header-button",children:Object(m.jsx)("button",{onClick:function(){return t(n.running?L():F())},className:"mdl-button mdl-js-button mdl-button--raised",children:Object(m.jsx)("i",{className:"material-icons",children:n.running?"pause":"play_arrow"})})})}),Object(m.jsx)("div",{className:"mdl-navigation mdl-layout--large-screen-only",children:Object(m.jsx)(B,{error:n.error,xSize:r.xCount,ySize:r.yCount,aliveCells:c.cells.size,cycle:c.step})})]})})})),Q=n(12),Z=n(20),J=n(7),K=n.n(J),$=n(6),ee=K.a.mark(se),te=K.a.mark(ie),ne=K.a.mark(le),re=function(e){return e.cells};function ce(){U.clear()}function ae(e){U.set(e.step,e.cells)}function se(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=$.b,e.t1=A,e.next=4,U.getLast();case 4:return e.t2=e.sent,e.t3={type:e.t1,restore:e.t2},e.next=8,(0,e.t0)(e.t3);case 8:case"end":return e.stop()}}),ee)}function ie(){var e,t;return K.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object($.c)(re);case 2:if(e=n.sent,!((t=e.step-1)<0)){n.next=6;break}return n.abrupt("return");case 6:return n.t0=$.b,n.t1=P,n.next=10,U.get(t);case 10:return n.t2=n.sent,n.t3={type:n.t1,cells:n.t2},n.next=14,(0,n.t0)(n.t3);case 14:case"end":return n.stop()}}),te)}function le(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object($.d)(S,ce);case 2:return e.next=4,Object($.d)([N,C,y],ae);case 4:return e.next=6,Object($.d)(T,se);case 6:return e.next=8,Object($.d)(R,ie);case 8:setInterval((function(){U.keys().then((function(e){if(e.length>500){var t=e.slice(0,e.length-500);t.forEach((function(e){return U.delete(e)})),console.log("Removing ".concat(t.length," keys"))}}))}),6e4);case 9:case"end":return e.stop()}}),ne)}var oe=le,ue=K.a.mark(me),de=K.a.mark(he),fe=K.a.mark(pe),be=function(e){return e.cells},je=function(e){return e.size};function me(e){var t,n,r,c,a,s;return K.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.coords,n=t.x,r=t.y,i.next=3,Object($.c)(be);case 3:return c=i.sent,a=new Map(c.cells),s=u(n,r),i.next=8,Object($.b)({type:y,cells:a.has(s)?a.delete(s)&&a:a.set(s,1),step:c.step});case 8:case"end":return i.stop()}}),ue)}function he(e){var t,n,r,c,a,s,i,l,o,d,f;return K.a.wrap((function(b){for(;;)switch(b.prev=b.next){case 0:return t=e.pattern,b.next=3,Object($.c)(be);case 3:return n=b.sent,b.next=6,Object($.c)(je);case 6:if(r=b.sent,c=r.xCount,a=r.yCount,!n.readOnly){b.next=13;break}return b.next=12,Object($.b)({type:"READ_ONLY_ERROR"});case 12:return b.abrupt("return",b.sent);case 13:return s=t.split("\n"),i=s.length,l=0,s.forEach((function(e){var t=e.length;t>l&&(l=t)})),o=Math.floor((a-i)/2),d=Math.floor((c-l)/2),f=[],s.forEach((function(e,t){e.split("").forEach((function(e,n){var r=d+n,c=o+t;"*"===e&&f.push(u(r,c))}))})),b.next=23,Object($.b)({type:N,pattern:t,cells:f.reduce((function(e,t){return e.set(t,1)}),new Map(n.cells)),step:n.step});case 23:case"end":return b.stop()}}),de)}function pe(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object($.d)(g,he);case 2:return e.next=4,Object($.d)(x,me);case 4:case"end":return e.stop()}}),fe)}var ve,Oe=pe,xe=K.a.mark(Ce),ye=K.a.mark(ke),ge=K.a.mark(ze),Ne=K.a.mark(Re),Ee=function(e){return e.cells},we=function(e){return e.interval},_e=function(e){return e.size};function Ce(){var e,t,n;return K.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return Se(),r.next=3,Object($.c)(we);case 3:if((e=r.sent).running){r.next=6;break}return r.abrupt("return");case 6:return t=Math.round(6e4/e.frequency),r.next=9,ze();case 9:return n=r.sent,r.next=12,Object($.b)(n);case 12:return r.next=14,Object($.a)(t);case 14:return ve=r.sent,r.next=17,Ce();case 17:case"end":return r.stop()}}),xe)}function ke(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Se(),e.t0=$.b,e.next=4,ze();case 4:return e.t1=e.sent,e.next=7,(0,e.t0)(e.t1);case 7:case"end":return e.stop()}}),ye)}function ze(){var e,t,n,r,c;return K.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object($.c)(Ee);case 2:return e=a.sent,a.next=5,Object($.c)(_e);case 5:if(t=a.sent,n=e.cells,r=e.step,c=j(n,t),!b(n,c)){a.next=10;break}return a.abrupt("return",{type:k,error:"Life is Stopped!!"});case 10:return a.abrupt("return",{type:C,step:r+1,cells:c});case 11:case"end":return a.stop()}}),ge)}function Se(){clearInterval(ve)}function Re(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object($.d)(E,Ce);case 2:return e.next=4,Object($.d)(_,ke);case 4:return e.next=6,Object($.d)([R,w,S],Se);case 6:case"end":return e.stop()}}),Ne)}var Pe=Re,Te={cells:new Map,step:0,readOnly:!1},Ae={rectSize:10,canvasHeight:0,canvasWidth:0,xCount:0,yCount:0},Le={frequency:120,running:!1,error:null},Fe=Object(Z.a)(),Ie=Object(Q.c)({cells:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Te,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case A:return Object(l.a)(Object(l.a)({},e),t.restore);case y:return e.readOnly?e:Object(l.a)(Object(l.a)({},e),{},{cells:t.cells});case N:return Object(l.a)(Object(l.a)({},e),{},{cells:t.cells});case C:return Object(l.a)(Object(l.a)({},e),{},{step:t.step,cells:t.cells,readOnly:!1});case P:return Object(l.a)(Object(l.a)({},e),{},{readOnly:!0,cells:t.cells,step:e.step-1});case S:return Object(l.a)({},Te);default:return e}},size:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ae,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v:var n=e.rectSize,r=Math.floor(t.sizes.width/n),c=Math.floor(t.sizes.height/n);return Object(l.a)(Object(l.a)({},e),{},{xCount:r,yCount:c,canvasWidth:n*r,canvasHeight:n*c});case O:var a=e.rectSize,s=a+t.direction;return s<e.xCount&&s<e.yCount&&s>=2?Object(l.a)(Object(l.a)({},e),{},{rectSize:s,xCount:Math.floor(e.canvasWidth/s),yCount:Math.floor(e.canvasHeight/s)}):e;default:return e}},interval:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Le,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case z:return Object(l.a)(Object(l.a)({},e),{},{error:null,frequency:t.frequency});case E:return Object(l.a)(Object(l.a)({},e),{},{error:null,running:!0});case w:case S:case P:case _:return Object(l.a)(Object(l.a)({},e),{},{error:null,running:!1});case k:return Object(l.a)(Object(l.a)({},e),{},{running:!1,error:t.error});default:return e}}}),Me=Object(Q.e)(Ie,Object(Q.a)(Fe));Fe.run(Oe),Fe.run(oe),Fe.run(Pe);var De=Me,qe=(n(33),n(34),function(){return Object(m.jsx)(i.a,{store:De,className:"App",children:Object(m.jsxs)("div",{id:"App-root",className:"mdl-layout mdl-js-layout mdl-layout--fixed-header",children:[Object(m.jsx)(V,{}),Object(m.jsx)(I,{}),Object(m.jsx)(X,{})]})})});n(35);s.a.render(Object(m.jsx)(qe,{}),document.getElementById("root"))}},[[36,1,2]]]);
//# sourceMappingURL=main.ce250454.chunk.js.map